package com.bupt.zhidian.Service;

import com.bupt.zhidian.pojo.BPS;
import com.bupt.zhidian.pojo.Price;
import com.bupt.zhidian.pojo.Report;
import com.bupt.zhidian.pojo.Share;
import com.gargoylesoftware.htmlunit.BrowserVersion;
import com.gargoylesoftware.htmlunit.Page;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.WebResponse;
import org.json.JSONArray;
import org.json.JSONObject;
import org.springframework.stereotype.Service;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

@Service
public class VLServiceImpl implements VLService{
    @Override
    public String getPage(int market, String code) throws Exception {
        String stringMarket1 = null;
        String stringMarket2 = null;
        if(market == 1) {
            stringMarket1 = "SH";
            stringMarket2 = "sh";
        }
        WebClient webClient = new WebClient(BrowserVersion.CHROME);
        String url = "http://10.122.252.243:9080/" + "info/get/firm/Report/" + stringMarket2 + "/" + code;
        Page page = webClient.getPage(url);
        WebResponse response = page.getWebResponse();
        String jsonString = response.getContentAsString();
        //String jsonString = "{\"nd\":[{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2021年报\",\"EQUITY_MULTIPLIER\":11.997258993421,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":135958000000,\"REPORT_DATE\":\"2021-12-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":137319000000,\"OPERATE_TAX_ADD\":2004000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.66476275499,\"TOTAL_LIABILITIES\":7458539000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":29134000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":8.75,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":17297000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.6684413944,\"TOTAL_INCOME\":191085000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8136757000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":53766000000,\"ASSET_DISPOSAL_INCOME\":26000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":28.152391324837,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":5305000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":4504000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.580887549753,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.023743680835,\"NOTICE_DATE\":\"2022-04-28 00:00:00\",\"EXCHANGE_INCOME\":813000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":190982000000,\"PARENT_NETPROFIT\":53003000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":49978000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2020年报\",\"EQUITY_MULTIPLIER\":12.310326299865,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":138581000000,\"REPORT_DATE\":\"2020-12-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":137528000000,\"OPERATE_TAX_ADD\":2117000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.876738474341,\"TOTAL_LIABILITIES\":7304401000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":33946000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":10.81,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":18980000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.7888796493,\"TOTAL_INCOME\":196521000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":7950218000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":58993000000,\"ASSET_DISPOSAL_INCOME\":-8000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":30.039616262017,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":7689000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":2220000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.867662265015,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.026261309146,\"NOTICE_DATE\":\"2021-03-27 00:00:00\",\"EXCHANGE_INCOME\":-215000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":196384000000,\"PARENT_NETPROFIT\":58325000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":46702000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2019年报\",\"EQUITY_MULTIPLIER\":12.487151791905,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":144523000000,\"REPORT_DATE\":\"2019-12-31 00:00:00\",\"UPDATE_DATE\":\"2021-03-27 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":131288000000,\"OPERATE_TAX_ADD\":1946000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.991768686209,\"TOTAL_LIABILITIES\":6444878000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":24774000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":12.29,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":13571000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.8951275748,\"TOTAL_INCOME\":190794000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":7005929000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":59506000000,\"ASSET_DISPOSAL_INCOME\":1470000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":31.205948984729,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":10311000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":3765000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":99.000100830168,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.02868451702,\"NOTICE_DATE\":\"2020-04-25 00:00:00\",\"EXCHANGE_INCOME\":312000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":190688000000,\"PARENT_NETPROFIT\":58911000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":43052000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2018年报\",\"EQUITY_MULTIPLIER\":13.147719386262,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":111844000000,\"REPORT_DATE\":\"2018-12-31 00:00:00\",\"UPDATE_DATE\":\"2020-04-25 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":114454000000,\"OPERATE_TAX_ADD\":1852000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":92.394118168928,\"TOTAL_LIABILITIES\":5811226000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":39009000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":13.14,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":15797000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.9095630541,\"TOTAL_INCOME\":170969000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":6289606000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":56515000000,\"ASSET_DISPOSAL_INCOME\":51000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":33.075820091885,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":8769000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":798000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.936565513581,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.027499334908,\"NOTICE_DATE\":\"2019-03-26 00:00:00\",\"EXCHANGE_INCOME\":1155000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":170865000000,\"PARENT_NETPROFIT\":55914000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":42541000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2017年报\",\"EQUITY_MULTIPLIER\":14.240031555623,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":106912000000,\"REPORT_DATE\":\"2017-12-31 00:00:00\",\"UPDATE_DATE\":\"2019-03-26 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":113814000000,\"OPERATE_TAX_ADD\":1610000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":92.977543651544,\"TOTAL_LIABILITIES\":5706255000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":45580000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":14.45,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":13585000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.9171201174,\"TOTAL_INCOME\":168816000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":6137240000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":55002000000,\"ASSET_DISPOSAL_INCOME\":516000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":32.619099864191,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":14826000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":-3797000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.647321915567,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.028116046159,\"NOTICE_DATE\":\"2018-04-28 00:00:00\",\"EXCHANGE_INCOME\":2723000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":168619000000,\"PARENT_NETPROFIT\":54258000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":41047000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2016年报\",\"EQUITY_MULTIPLIER\":15.705897021993,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":108120000000,\"REPORT_DATE\":\"2016-12-31 00:00:00\",\"UPDATE_DATE\":\"2017-04-01 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":107573000000,\"OPERATE_TAX_ADD\":4444000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":93.632964748211,\"TOTAL_LIABILITIES\":5484329000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":40692000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":16.35,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":7033000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.9847715224,\"TOTAL_INCOME\":161251000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":5857263000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":53678000000,\"ASSET_DISPOSAL_INCOME\":null,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":33.38350166675,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":16297000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":2812000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.92134580275,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.02949874858,\"NOTICE_DATE\":\"2017-04-01 00:00:00\",\"EXCHANGE_INCOME\":-528000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":160792000000,\"PARENT_NETPROFIT\":53099000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":37238000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2015年报\",\"EQUITY_MULTIPLIER\":15.832868801004,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":113009000000,\"REPORT_DATE\":\"2015-12-31 00:00:00\",\"UPDATE_DATE\":\"2017-04-01 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":96536000000,\"OPERATE_TAX_ADD\":8976000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":93.684025222665,\"TOTAL_LIABILITIES\":4725752000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":27798000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":18.82,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":461000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":1.1037981982,\"TOTAL_INCOME\":147533000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":5044352000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":50997000000,\"ASSET_DISPOSAL_INCOME\":null,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":34.798362333675,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":15880000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":2991000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":99.22936643332,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.031719831745,\"NOTICE_DATE\":\"2016-04-07 00:00:00\",\"EXCHANGE_INCOME\":-713000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":146550000000,\"PARENT_NETPROFIT\":50604000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":32034000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2014年报\",\"EQUITY_MULTIPLIER\":15.936813718974,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":98183000000,\"REPORT_DATE\":\"2014-12-31 00:00:00\",\"UPDATE_DATE\":\"2016-04-07 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":76264000000,\"OPERATE_TAX_ADD\":8147000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":93.725219999218,\"TOTAL_LIABILITIES\":3932639000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":21346000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":21.02,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":-262000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":1.2026334524,\"TOTAL_INCOME\":123624000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":4195924000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":47360000000,\"ASSET_DISPOSAL_INCOME\":null,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":38.447487843093,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":14670000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":2262000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":99.294763513514,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.031279896811,\"NOTICE_DATE\":\"2015-03-19 00:00:00\",\"EXCHANGE_INCOME\":-53000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":123181000000,\"PARENT_NETPROFIT\":47026000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":28475000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2013年报\",\"EQUITY_MULTIPLIER\":17.758906899198,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":85177000000,\"REPORT_DATE\":\"2013-12-31 00:00:00\",\"UPDATE_DATE\":\"2015-03-19 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":59259000000,\"OPERATE_TAX_ADD\":6813000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":94.369022791345,\"TOTAL_LIABILITIES\":3472898000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":13904000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":21.53,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":820000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":1.2071788465,\"TOTAL_INCOME\":100459000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":3680125000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":41200000000,\"ASSET_DISPOSAL_INCOME\":null,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":41.193820926861,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":12649000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":-1565000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":99.325242718447,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.029304852507,\"NOTICE_DATE\":\"2014-03-20 00:00:00\",\"EXCHANGE_INCOME\":767000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":100015000000,\"PARENT_NETPROFIT\":40922000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":25830000000,\"POLICY_BONUS_EXPENSE\":null}],\"bgq\":[{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2022中报\",\"EQUITY_MULTIPLIER\":12.258792043421,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":68681000000,\"REPORT_DATE\":\"2022-06-30 00:00:00\",\"UPDATE_DATE\":\"2022-08-27 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":68064000000,\"OPERATE_TAX_ADD\":1082000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.842589412905,\"TOTAL_LIABILITIES\":7812093000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":15281000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":5.13,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":8709000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.3676803714,\"TOTAL_INCOME\":98660000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8505959000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":30596000000,\"ASSET_DISPOSAL_INCOME\":19000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":31.016584891124,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":3937000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":361000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"中报\",\"PARENT_NETPROFIT_RATIO\":98.620734736567,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.011854315125,\"NOTICE_DATE\":\"2022-08-27 00:00:00\",\"EXCHANGE_INCOME\":3719000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":98644000000,\"PARENT_NETPROFIT\":30174000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":24195000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2022一季报\",\"EQUITY_MULTIPLIER\":12.106344600198,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":34502000000,\"REPORT_DATE\":\"2022-03-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":30414000000,\"OPERATE_TAX_ADD\":513000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.739868366347,\"TOTAL_LIABILITIES\":7727317000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":8325000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":3.28,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":6188000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.2366811594,\"TOTAL_INCOME\":50011000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8423074000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":19597000000,\"ASSET_DISPOSAL_INCOME\":29000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":39.192432302708,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":3145000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":-150000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"一季报\",\"PARENT_NETPROFIT_RATIO\":98.933510231158,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.006038950518,\"NOTICE_DATE\":\"2022-04-28 00:00:00\",\"EXCHANGE_INCOME\":194000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":50002000000,\"PARENT_NETPROFIT\":19388000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":11688000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2021年报\",\"EQUITY_MULTIPLIER\":11.997258993421,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":135958000000,\"REPORT_DATE\":\"2021-12-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":137319000000,\"OPERATE_TAX_ADD\":2004000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.66476275499,\"TOTAL_LIABILITIES\":7458539000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":29134000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":8.75,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":17297000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.6684413944,\"TOTAL_INCOME\":191085000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8136757000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":53766000000,\"ASSET_DISPOSAL_INCOME\":26000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":28.152391324837,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":5305000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":4504000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.580887549753,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.023743680835,\"NOTICE_DATE\":\"2022-04-28 00:00:00\",\"EXCHANGE_INCOME\":813000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":190982000000,\"PARENT_NETPROFIT\":53003000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":49978000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2021三季报\",\"EQUITY_MULTIPLIER\":12.025210885997,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":101389000000,\"REPORT_DATE\":\"2021-09-30 00:00:00\",\"UPDATE_DATE\":\"2021-10-30 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":101408000000,\"OPERATE_TAX_ADD\":1477000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.684137521742,\"TOTAL_LIABILITIES\":7393760000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":22320000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":7.25,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":11218000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.5261323713,\"TOTAL_INCOME\":143537000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8064383000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":42129000000,\"ASSET_DISPOSAL_INCOME\":43000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":29.36146190516,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":5219000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":5849000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"三季报\",\"PARENT_NETPROFIT_RATIO\":98.592418524057,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.017919147658,\"NOTICE_DATE\":\"2021-10-30 00:00:00\",\"EXCHANGE_INCOME\":414000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":143484000000,\"PARENT_NETPROFIT\":41536000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":34641000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2021中报\",\"EQUITY_MULTIPLIER\":12.299166794103,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":67662000000,\"REPORT_DATE\":\"2021-06-30 00:00:00\",\"UPDATE_DATE\":\"2022-08-27 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":67200000000,\"OPERATE_TAX_ADD\":1000000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.869367927594,\"TOTAL_LIABILITIES\":7462659000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":15266000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":5.36,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":6745000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.3758273484,\"TOTAL_INCOME\":97404000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8123120000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":30204000000,\"ASSET_DISPOSAL_INCOME\":31000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":31.021414265907,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":4518000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":6145000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"中报\",\"PARENT_NETPROFIT_RATIO\":98.788239968216,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.012115093952,\"NOTICE_DATE\":\"2021-08-28 00:00:00\",\"EXCHANGE_INCOME\":242000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":97365000000,\"PARENT_NETPROFIT\":29838000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":23246000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2021一季报\",\"EQUITY_MULTIPLIER\":12.158885547844,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":33672000000,\"REPORT_DATE\":\"2021-03-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":30692000000,\"OPERATE_TAX_ADD\":532000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.775562027744,\"TOTAL_LIABILITIES\":7403530000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":8124000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":3.35,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":3187000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.2354591901,\"TOTAL_INCOME\":49549000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":8066995000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":18857000000,\"ASSET_DISPOSAL_INCOME\":21000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":38.07802592787,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":3450000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":3582000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"一季报\",\"PARENT_NETPROFIT_RATIO\":99.151508723551,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.006183597608,\"NOTICE_DATE\":\"2021-04-30 \t00:00:00\",\"EXCHANGE_INCOME\":346000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":49522000000,\"PARENT_NETPROFIT\":18697000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":11181000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2020年报\",\"EQUITY_MULTIPLIER\":12.310326299865,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":138581000000,\"REPORT_DATE\":\"2020-12-31 00:00:00\",\"UPDATE_DATE\":\"2022-04-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":137528000000,\"OPERATE_TAX_ADD\":2117000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":91.876738474341,\"TOTAL_LIABILITIES\":7304401000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":33946000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":10.81,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":18980000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.7888796493,\"TOTAL_INCOME\":196521000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":7950218000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":58993000000,\"ASSET_DISPOSAL_INCOME\":-8000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":30.039616262017,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":7689000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":2220000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"年报\",\"PARENT_NETPROFIT_RATIO\":98.867662265015,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.026261309146,\"NOTICE_DATE\":\"2021-03-27 00:00:00\",\"EXCHANGE_INCOME\":-215000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":196384000000,\"PARENT_NETPROFIT\":58325000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":46702000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2020三季报\",\"EQUITY_MULTIPLIER\":13.223720916608,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":103204000000,\"REPORT_DATE\":\"2020-09-30 00:00:00\",\"UPDATE_DATE\":\"2021-10-30 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":103604000000,\"OPERATE_TAX_ADD\":1516000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":92.437831936214,\"TOTAL_LIABILITIES\":7094122000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":27787000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":8.39,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":14934000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.6156504642,\"TOTAL_INCOME\":148794000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":7674479000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":45190000000,\"ASSET_DISPOSAL_INCOME\":23000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":30.383712877611,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":6442000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":781000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"三季报\",\"PARENT_NETPROFIT_RATIO\":99.008630227927,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.020262515865,\"NOTICE_DATE\":\"2020-10-31 00:00:00\",\"EXCHANGE_INCOME\":18000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":148731000000,\"PARENT_NETPROFIT\":44742000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":33193000000,\"POLICY_BONUS_EXPENSE\":null},{\"SECUCODE\":\"600000.SH\",\"DEVELOP_EXPENSE\":null,\"REPORT_TYPE\":\"2020中报\",\"EQUITY_MULTIPLIER\":13.144756411937,\"NOTE_RECE\":null,\"CREDITOR_INVEST\":null,\"INVEST_REALESTATE\":null,\"INTEREST_NI\":70088000000,\"REPORT_DATE\":\"2020-06-30 00:00:00\",\"UPDATE_DATE\":\"2021-08-28 00:00:00\",\"OTHER_RECE\":null,\"SECURITY_CODE\":\"600000\",\"DEFER_TAX_ASSET\":null,\"NET_CONTRACT_RESERVE\":null,\"TOTAL_COST\":72194000000,\"OPERATE_TAX_ADD\":952000000,\"MANAGE_EXPENSE\":null,\"ORG_TYPE\":\"银行\",\"INVENTORY\":null,\"FIXED_ASSET\":null,\"EARNED_PREMIUM\":null,\"DEBT_ASSET_RATIO\":92.392403718551,\"TOTAL_LIABILITIES\":6948926000000,\"OTHER_EQUITY_INVEST\":null,\"OPERATE_COST\":null,\"NONBUSINESS_EXPENSE\":null,\"FEE_COMMISSION_NI\":16961000000,\"TOTAL_CURRENT_ASSETS\":null,\"NET_COMPENSATE_EXPENSE\":null,\"ACCOUNTS_RECE\":null,\"FEE_COMMISSION_EXPENSE\":null,\"SURRENDER_VALUE\":null,\"ROE\":5.53,\"CIP\":null,\"RESEARCH_EXPENSE\":null,\"INVEST_INCOME\":12295000000,\"INTANGIBLE_ASSET\":null,\"ORG_CODE\":\"10002252\",\"HOLD_MATURITY_INVEST\":null,\"TRADE_FINASSET\":null,\"JROA\":0.4027526618,\"TOTAL_INCOME\":101448000000,\"OTHER_CREDITOR_INVEST\":null,\"GOODWILL\":null,\"TOTAL_EXPENSE\":null,\"TOTAL_ASSETS\":7521101000000,\"FINANCE_RECE\":null,\"TOTAL_NONCURRENT_ASSETS\":null,\"LONG_EQUITY_INVEST\":null,\"AVAILABLE_SALE_FINASSET\":null,\"NETPROFIT\":29254000000,\"ASSET_DISPOSAL_INCOME\":12000000,\"LONG_RECE\":null,\"LONG_PREPAID_EXPENSE\":null,\"SALE_NPR\":28.848107132644,\"SECURITY_NAME_ABBR\":\"浦发银行\",\"SECURITY_TYPE_CODE\":\"058001001\",\"INCOME_TAX\":4312000000,\"ASSET_IMPAIRMENT_INCOME\":null,\"FINANCE_EXPENSE\":null,\"FAIRVALUE_CHANGE_INCOME\":972000000,\"CURRENCY\":\"CNY\",\"REPORT_DATE_NAME\":\"中报\",\"PARENT_NETPROFIT_RATIO\":98.977917549737,\"USERIGHT_ASSET\":null,\"TOTAL_ASSETS_TR\":0.01396114691,\"NOTICE_DATE\":\"2020-08-29 00:00:00\",\"EXCHANGE_INCOME\":-229000000,\"MONETARYFUNDS\":null,\"TOTAL_OPERATE_INCOME\":101407000000,\"PARENT_NETPROFIT\":28955000000,\"SALE_EXPENSE\":null,\"CREDIT_IMPAIRMENT_INCOME\":null,\"BUSINESS_MANAGE_EXPENSE\":21588000000,\"POLICY_BONUS_EXPENSE\":null}]}";

        JSONObject jsonObject = new JSONObject(jsonString);

        if(jsonObject.has("message")) {
            JSONObject errorObject = new JSONObject();
            errorObject.put("message", jsonObject.get("message"));
            errorObject.put("status", jsonObject.get("status"));
            return errorObject.toString();
        }

        JSONArray reports = jsonObject.getJSONArray("bgq");
        List<Report> reportList = new ArrayList<>();
        for(int i = 0; i < 5; i++) {
            Report temp = new Report();
            Date date = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss")
                    .parse(reports.getJSONObject(i).getString("REPORT_DATE"));
            temp.setDate(date);
            temp.setProfit(reports.getJSONObject(i).getInt("NETPROFIT"));
            reportList.add(temp);
        }

        String url1 = "http://10.122.252.243:9090/" + "stock/dayKline/" + market + "/" + code;
        Page page1 = webClient.getPage(url1);
        WebResponse response1 = page1.getWebResponse();
        String jsonString1 = response1.getContentAsString();
        JSONObject jsonObject1 = new JSONObject(jsonString1);

        if(jsonObject1.has("message")) {
            JSONObject errorObject = new JSONObject();
            errorObject.put("message", jsonObject.get("message"));
            errorObject.put("status", jsonObject.get("status"));
            return errorObject.toString();
        }

        JSONArray klines = jsonObject1.getJSONArray("klines");
        List<Price> priceList = new ArrayList<>();
        for(int i = 0; i < klines.length(); i++) {
            Price temp = new Price();
            temp.setPrice(Float.parseFloat(klines.getJSONObject(i).getString("closing")));
            Date date = new SimpleDateFormat("yyyy-MM-dd").parse(klines.getJSONObject(i).getString("time"));
            temp.setDate(date);
            priceList.add(temp);
        }
        
        Page page2 = webClient.getPage("https://xueqiu.com/");
        String urlOfXq = "https://stock.xueqiu.com/v5/stock/f10/cn/shareschg.json?symbol=" + stringMarket1 + code
                + "&count=100&extend=true";
        Page page3 = webClient.getPage(urlOfXq);
        WebResponse responseOfXq = page3.getWebResponse();
        String jsonString2 = responseOfXq.getContentAsString();
        JSONObject jsonObjectOfXq = new JSONObject(jsonString2);
        JSONArray jsonArray = jsonObjectOfXq.getJSONObject("data").getJSONArray("items");

        if(jsonArray.length() == 0) {
            JSONObject error = new JSONObject();
            error.put("status", -1);
            error.put("message", "股票代码不合法");
            return error.toString();
        }

        List<Share> shareList = new ArrayList<>();
        for(int i = 0; i < jsonArray.length(); i++) {
            Share temp = new Share();
            temp.setDate(stampToTime(jsonArray.getJSONObject(i).getString("chg_date")));
            temp.setShare(jsonArray.getJSONObject(i).getBigInteger("total_shares"));
            shareList.add(temp);
        }

        String urlOfDf = "http://emweb.securities.eastmoney.com/PC_HSF10/NewFinanceAnalysis/ZYZBAjaxNew?type=0&code=" + stringMarket1 + code;
        Page page4 = webClient.getPage(urlOfDf);
        WebResponse response2 = page4.getWebResponse();
        String jsonString3 = response2.getContentAsString();
        JSONObject jsonObject2 = new JSONObject(jsonString3);
        List<BPS> bpsList = new ArrayList<>();
        for(int i = 0; i < jsonObject2.getJSONArray("data").length(); i++) {
            BPS temp = new BPS();
            Date date = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(jsonObject2.getJSONArray("data").getJSONObject(i).getString("REPORT_DATE"));
            temp.setDate(date);
            temp.setBps(jsonObject2.getJSONArray("data").getJSONObject(i).getFloat("BPS"));
            bpsList.add(temp);
        }

        JSONObject bigObject = new JSONObject();
        JSONArray points = new JSONArray();
        for(int i = 0, shareCount = 0, reportCount = 0, bpsCount = 0; i < priceList.size(); i++) {
            JSONObject temp = new JSONObject();
            if(priceList.get(i).getDate().before(shareList.get(shareCount).getDate())) {
                if(shareCount < shareList.size() - 1) {
                    shareCount++;
                }
            }
            if(priceList.get(i).getDate().before(reportList.get(reportCount).getDate())) {
                if(reportCount < reportList.size() - 1) {
                    reportCount++;
                }
            }
            if(priceList.get(i).getDate().before(bpsList.get(bpsCount).getDate())) {
                if(reportCount < bpsList.size() - 1) {
                    bpsCount++;
                }
            }
            temp.put("time", priceList.get(i).getDate());
            temp.put("EPS", reportList.get(reportCount).getProfit()/shareList.get(shareCount).getShare().longValue());
            temp.put("PE", shareList.get(shareCount).getShare().longValue()*priceList.get(i).getPrice()
                    /reportList.get(reportCount).getProfit());
            temp.put("closing", priceList.get(i).getPrice());
            temp.put("BPS", bpsList.get(bpsCount).getBps());
            temp.put("PB", priceList.get(i).getPrice()/bpsList.get(bpsCount).getBps());
            points.put(temp);
        }
        bigObject.put("points", points);
        float maxPE = points.getJSONObject(0).getFloat("PE");
        float minPE = maxPE;
        float maxPB = points.getJSONObject(0).getFloat("PB");
        float minPB = maxPB;
        for(int i = 0; i < points.length(); i++) {
            if(points.getJSONObject(i).getFloat("PE") > maxPE) {
                maxPE = points.getJSONObject(i).getFloat("PE");
            }
            if(points.getJSONObject(i).getFloat("PB") > maxPB) {
                maxPB = points.getJSONObject(i).getFloat("PB");
            }
            if(points.getJSONObject(i).getFloat("PE") < minPE) {
                minPE = points.getJSONObject(i).getFloat("PE");
            }
            if(points.getJSONObject(i).getFloat("PB") < minPB) {
                minPB = points.getJSONObject(i).getFloat("PB");
            }
        }
        bigObject.put("maxPB", maxPB);
        bigObject.put("maxPE", maxPE);
        bigObject.put("minPE", minPE);
        bigObject.put("minPB", minPB);
        bigObject.put("status", 0);

        return bigObject.toString();
    }

    public static Date stampToTime(String s) throws Exception {
        SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        long lt = new Long(s); //将时间戳转换为时间
        Date date = new Date(lt); //将时间调整为yyyy-MM-dd HH:mm:ss时间样式
        return date;
    }
}
